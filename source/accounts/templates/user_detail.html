{% extends 'base.html' %}
{% block title %}{{ user_obj.username }}{% endblock %}
{% block menu %}
    {% if user_obj == request.user %}
        <li><a href="{% url 'accounts:user_update' user_obj.pk %}">Edit profile</a></li>
        <li><a href="{% url 'accounts:user_delete' user_obj.pk %}">Delete profile</a></li>
{#        <li><a href="{% url 'accounts:user_change_password' user_obj.pk %}">Change password</a></li>#}
    {% endif %}
{% endblock %}
{% block content %}
    {% if  user_obj.profile.photo %}
        <img src="{{ user_obj.profile.photo.url }}" style="width: 300px; height: 300px" class="user_photo">
    {% endif %}
    <h1>Профиль: {{ user_obj.username }}</h1>
    <p>Имя: <b>{{ user_obj.first_name }}</b></p>
    <p>Фамилия: {{ user_obj.last_name }}</p>
    <p>Почта: {{ user_obj.email }}</p>
    <p>Тип: {{ user_obj.profile.type }}</p>
    <p>Телефон: {{ user_obj.profile.mobile_phone }}</p>
    <p>Страна: {{ user_obj.profile.country }}</p>
    <p>Город: {{ user_obj.profile.city }}</p>
    <p>Уведомления: {{ user_obj.profile.notification }}</p>
    {% if user_obj.profile.type == 'driver' %}
        <p>Статус: {{ user_obj.profile.status }}</p>
        <p>Модель авто: {{ user_obj.profile.car_model }}</p>
        <p>Номер авто: {{ user_obj.profile.car_number }}</p>
        <p>Кол-во сидений: {{ user_obj.profile.car_seats }}</p>
    {% endif %}
    <h2>История поездок</h2>
    {% for announcement in history %}
        <div class="card" style="width: 18rem;">
            {% if  announcement.image.all.first.photos.url %}
                <img src="{{ ad.image.all.first.photos.url }}" class="card-img-top" alt="...">
            {% else %}
                <img src="/uploads/no_photo.jpg" class="card-img-top" alt="...">
            {% endif %}
            <div class="card-body">
                <h5 class="card-title">Откуда: {{ announcement.place_from }}</h5>
                <h5 class="card-title">Куда: {{ announcement.place_to }}</h5>
                <p class="card-text">Описание: {{ announcement.description }}</p>
                <p class="card-text">Время: {{ announcement.departure_time }}</p>
                <p class="card-text">Места: {{ announcement.seats }}</p>
                <p class="card-text">Багаж: {{ announcement.luggage }}</p>
                <p class="card-text">Автор:  <a href="{% url 'accounts:user_detail' announcement.author.pk %}">{{ announcement.author}}</a></p>
                <a href="{% url 'webapp:announce_detail' announcement.pk%}" class="btn btn-success">Посмотреть</a>
                {% if user not in announcement.clients.all and user.is_authenticated and user != announcement.author and announcement.status == 'active' and announcement.seats > 0 %}
                    <a href="{% url 'webapp:client_add' announcement.pk %}">Присоединиться</a>
                {% elif user in announcement.clients.all %}
                    <a href="{% url 'webapp:client_delete' announcement.pk %}">Отказаться</a>
                {% endif %}
            </div>
        </div>
        {% empty %}
            <p>Пока нет поездок</p>
        {% endfor %}
{% endblock %}